language: node_js
node_js:
- stable
dist: trusty
sudo: true
cache:
  yarn: true
  directories:
  - node_modules
before_install:
- yarn global add @angular/cli@6.0.8
install:
- yarn install
script:
- yarn ci:travis
branches:
  only:
  - develop
notifications:
  email:
    recipients:
      - krbaio3@gmail.com
    on_success: never # default: change
    on_failure: always # default: always
env:
  global:
    - apiKey=$apiKey
    - authDomain=$authDomain
    - databaseURL=$databaseURL
    - projectId=$projectId
    - storageBucket=$storageBucket
    - messagingSenderId=$messagingSenderId
deploy:
  - provider: heroku
    api_key:
      secure: $HEROKU_API_KEY
    app: whis-ng
    local_dir: dist
    skip_cleanup: true
    on:
      branch: "develop"
